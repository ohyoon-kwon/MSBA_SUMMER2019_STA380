
For the green building problem, we wanted to explore and calculate how much money we can save on energy and utility bills. Because green building should be energy efficient and we will save more money (= profit, basically)

```{r}

library(mosaic)
library(readr)
library(tidyverse)
green = read_csv("greenbuildings.csv")
head(green)

```
```{r}
cluster<- green %>% group_by(cluster)
cluster
```
We have ordered the data by their cluster, and we analyze the hot days & cold days total to figure out the demand for energy distribution across the clusters.

```{r}
summary(green$hd_total07)
summary(green$cd_total_07)
```
We decide to only exam the clusters that have similar weather to Austin, so our conclusion would be more relatable and convincing. We take out the data with "net=1" because residents pay their own utility bills and as building owners won't save much.

```{r}

green_zero = green %>% filter(net == 0 ) 
green_one = green %>% filter(net == 1 )

a = data.frame(group ="cd",value= green_zero$cd_total_07)
b = data.frame(group = "hd", value= green_zero$hd_total07)
plot.data = rbind(a, b) 
plot.data %>% group_by(group)
ggplot(plot.data, aes(x=group, y=value, fill=group)) +
 geom_boxplot()

f = data.frame(group = "non_net", value = nrow(green_zero))
d = data.frame(group = 'net', value = nrow(green_one))
c = rbind(f,d)
ggplot(c, aes(x=group, y=value, fill = group))+
  geom_col()
```
To define the "Austin weather", we take heatdays > median and colddays <median. Next we only gona work with cluster that matches this condition.

```{r}

one_q = quantile(green_zero$cd_total_07, .5)
one_q
three_q= quantile(green_zero$hd_total07, .5)

green_filter = green_zero  %>% 
  filter(green_zero$cd_total_07 < one_q)

green_filt = green_filter %>%
  filter(green_filter$hd_total07 > three_q)

print(green_filt)
green_filt%>% group_by(cluster)%>%summarize(count = n())
```

Then we tried the exact same analysis done by the immature "data scientist" did in the problem, just on our selected dataset.
```{r}
df = green_filt %>% filter(green_filt$leasing_rate > 10)
df_green= df %>% filter(green_rating == 1)
df_non_green= df %>% filter(green_rating != 1)

summary(df_green$Rent)
summary(df_non_green$Rent)
```

```{r}
green = median(df_green$Rent)
non_green = median(df_non_green$Rent)
new_rent_dif = green- non_green
amt_saved = new_rent_dif * 250000
amt_saved

```
We found out that in clusters that have similar weathcer as Austin, the rent median difference isn't that great bewteen green and non-green buildings. So there is a way smaller "extra revenue" we gonna make and so far ($27,500, comparing to 650,000 computed by the guy), it seems we will recuperate the green building costs in way longer than the 7 years time period he calculated. So bad deal?

We continue to explore the revenue generated by energy savings.
```{r}
df_green
df_green$gas = df_green$cd_total_07 * df_green$Gas_Costs
df_green$elec = df_green$hd_total07 * df_green$Electricity_Costs

df_green$total_saved = (df_green$gas + df_green$elec) * 0.25
df_green$total_cost = (df_green$gas + df_green$elec) * 0.75
df_green
```
Here, we made some assumptions about the dataset:

cold days means demand for gas (heating),
hot days means demand for electricity (cooling A/C)

So our formulas are:

cd_total  * Gas_Costs = gas bill per year
hd_total * Electricity_Costs = electricity bill per year

These cost are per unit area per year.

We also assumed that green buildings in general can save 25% energy compare to non-green,
according to numbers from LEED and National Geographics websites. So we multiple our cost by 0.25, and count it as the cost saved (extra revenue)

```{r}
hist(df_green$total_saved, 10)
median_saved = median(df_green$total_saved)
yearly_saved = median_saved * 250000
yearly_saved
```
We calculated the median of total_saved in clusters that have similar weather in Austin, then multiplied it by our building's planned area in the problem, 250,000.

Our yearly saving on utility bills would be around 9,235,600.


```{r}
green_mediancost = median(df_green$total_cost)
green_mean = mean(df_green$total_cost)

df_non_green$gas = df_non_green$cd_total_07 * df_non_green$Gas_Costs
df_non_green$elec = df_non_green$hd_total07 * df_non_green$Electricity_Costs
df_non_green$total_cost = (df_non_green$gas + df_non_green$elec)

nongreen_median_cost = median(df_non_green$total_cost)
nongreen_mean = mean(df_non_green$total_cost)

b = data.frame(group = 'Green Buildings', value = green_mean)
a = data.frame(group = 'Nongreen Buildings', value = nongreen_mean)
viz = rbind(a, b)
viz %>% group_by(group)

ggplot(viz, aes(x=group, y=value, fill=group)) +
  geom_col() + ylab('Cost of Gas+Electricity per year') + xlab("Building Type")

```
hd/cdboth counts bp
```{r}

e = green_zero %>%
  filter(green_zero$hd_total07 > three_q)

r = green_zero  %>% 
  filter(green_zero$cd_total_07 < one_q)

c= green_filt

g= data.frame(group= "above hd", value = nrow(e))
d = data.frame(group= "below cd", value = nrow(r))
c = data.frame(group = "total", value = nrow(c))

viz = rbind(g,d,c)
viz %>% group_by(group)

ggplot(viz, aes(x=group, y=value, fill=group)) +
 geom_col() + ylab("demand count")

```

Because yearly extra saving(revenue) is around 9 million per year, the green building 5% premium fee 5 million extra cost will be recuperated in less than a year. On top of that, the building owner would save a lot more each year on the utility bills for the building running in general.

So based on our approach, we conclude that green building is a great idea. The immature data scientist's approach has the similar conclusion as ours, but he ignored too many factors.

Our approach explored deeper into the factor of weather, and utility cost.


